# ğŸ“± Event Planner - Scan Validation Service Environment Configuration
#
# ğŸ“‹ GUIDE D'UTILISATION :
# 1. Copier ce fichier en .env.local pour le dÃ©veloppement
# 2. Copier ce fichier en .env pour la production
# 3. Remplacer les valeurs par dÃ©faut par vos vraies clÃ©s
# 4. NE JAMAIS COMMITTER le fichier .env contenant des secrets !

# ===========================================
# ğŸš€ SERVEUR & ENVIRONNEMENT
# ===========================================
PORT=3005
# ğŸ¯ Port d'Ã©coute du service (doit Ãªtre unique par service)
NODE_ENV=development
# ğŸŒ Environnement : development | staging | production

# ===========================================
# ğŸ—„ï¸ BASE DE DONNÃ‰ES POSTGRESQL
# ===========================================
DB_HOST=localhost
# ğŸ  HÃ´te de la base de donnÃ©es (localhost en dev, RDS endpoint en prod)
DB_PORT=5432
# ğŸšª Port PostgreSQL (5432 par dÃ©faut)
DB_NAME=event_planner_scan
# ğŸ“Š Nom de la base de donnÃ©es (prÃ©fixe event_planner_ recommandÃ©)
DB_USER=postgres
# ğŸ‘¤ Utilisateur PostgreSQL (crÃ©er un utilisateur dÃ©diÃ© en prod)
DB_PASSWORD=postgres
# ğŸ” Mot de passe PostgreSQL (utiliser un mot de passe fort en prod)
DB_SSL=false
# ğŸ”’ Connexion SSL (true en production avec RDS)

# Pool de connexions pour optimiser les performances
DB_POOL_MIN=2
# ğŸ”¢ Nombre minimum de connexions dans le pool
DB_POOL_MAX=20
# ğŸ”¢ Nombre maximum de connexions dans le pool
DB_POOL_IDLE_TIMEOUT=30000
# â° Timeout d'inactivitÃ© des connexions (ms)
DB_CONNECTION_TIMEOUT=2000
# â° Timeout de connexion (ms)

# Bootstrap automatique de la base de donnÃ©es
# âš ï¸  DÃ‰SACTIVÃ‰ PAR DÃ‰FAUT EN PRODUCTION POUR SÃ‰CURITÃ‰
# âœ… true : CrÃ©e automatiquement les tables et index au dÃ©marrage
# âŒ false : NÃ©cessite une migration manuelle en production
DB_AUTO_BOOTSTRAP=false

# ===========================================
# ğŸ” QR CODE VALIDATION
# ===========================================
# ClÃ©s pour validation cryptographique des QR codes
# âš ï¸ IMPORTANT: Utiliser des clÃ©s sÃ©curisÃ©es en production
# ğŸ”‘ GÃ©nÃ©rer clÃ© HMAC : openssl rand -base64 32
QR_HMAC_SECRET=your_super_secure_qr_hmac_secret_change_in_production
# ğŸ” ClÃ© secrÃ¨te HMAC pour la validation des QR codes

# ClÃ©s RSA pour signature/verification avancÃ©e (optionnel)
# ğŸ”‘ GÃ©nÃ©rer : openssl genrsa -out private.pem 2048 && openssl rsa -in private.pem -pubout -out public.pem
QR_RSA_PUBLIC_KEY=-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...
-----END PUBLIC KEY-----
# ğŸ”‘ ClÃ© publique RSA pour vÃ©rifier les signatures QR codes
QR_RSA_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC...
-----END PRIVATE KEY-----
# ğŸ” ClÃ© privÃ©e RSA pour signer les QR codes (si applicable)

# Configuration QR code avancÃ©e
QR_MAX_VALIDITY=86400
# â° DurÃ©e maximale de validitÃ© des QR codes (secondes)
QR_MAX_SIZE=4096
# ğŸ“ Taille maximale acceptÃ©e des QR codes (octets)
QR_ALGORITHM=HS256
# ğŸ› ï¸ Algorithme de validation (HS256, RS256)

# ===========================================
# ğŸŒ INTER-SERVICES COMMUNICATION
# ===========================================
# Token partagÃ© pour communication entre services
# ğŸ”‘ GÃ©nÃ©rer : openssl rand -base64 32 (doit Ãªtre identique partout)
SHARED_SERVICE_TOKEN=shared-service-token-abcdef12345678901234567890
# ğŸ” Token pour authentifier les communications inter-services

# URLs des autres services (pour health checks et communication)
AUTH_SERVICE_URL=http://localhost:3000
# ğŸ” URL du service d'authentification
CORE_SERVICE_URL=http://localhost:3001
# ğŸ¯ URL du service principal
NOTIFICATION_SERVICE_URL=http://localhost:3002
# ğŸ“§ URL du service de notifications
PAYMENT_SERVICE_URL=http://localhost:3003
# ğŸ’³ URL du service de paiements
TICKET_GENERATOR_SERVICE_URL=http://localhost:3004
# ğŸ« URL du service de gÃ©nÃ©ration de tickets

# Timeout pour les appels HTTP inter-services
INTER_SERVICE_TIMEOUT=30000
# â° Timeout par dÃ©faut (30000ms = 30 secondes)
INTER_SERVICE_RETRY_ATTEMPTS=3
# ğŸ”¢ Nombre de tentatives de retry
INTER_SERVICE_RETRY_DELAY=1000
# â° DÃ©lai entre les retries (1000ms = 1 seconde)

# ===========================================
# ğŸŒ COMMUNICATION AVEC EVENT PLANNER CORE
# ===========================================
CORE_SERVICE_URL=http://localhost:3001
# ğŸ¯ URL du service Core pour validation des tickets
CORE_SERVICE_TIMEOUT=10000
# â° Timeout pour les appels au Core Service (10 secondes)
CORE_SERVICE_RETRIES=2
# ğŸ”¢ Nombre de tentatives de retry pour le Core Service

# Circuit Breaker Configuration
CIRCUIT_BREAKER_THRESHOLD=5
# âš¡ Seuil d'ouverture du circuit breaker (5 Ã©checs)
CIRCUIT_BREAKER_TIMEOUT=60000
# â° Timeout du circuit breaker ouvert (60 secondes)
CIRCUIT_BREAKER_RESET_TIMEOUT=30000
# ğŸ”„ Timeout de rÃ©initialisation du circuit breaker (30 secondes)

# ===========================================
# ğŸ“± SCAN CONFIGURATION
# ===========================================
QR_SCAN_TIMEOUT=5000
# â° Timeout pour le scan d'un QR code (5 secondes)
MAX_SCAN_ATTEMPTS=3
# ğŸ”¢ Nombre maximum de tentatives de scan
SCAN_RETRY_DELAY=1000
# â° DÃ©lai entre les tentatives de scan (1 seconde)
SCAN_VALIDATION_CACHE_TTL=300
# ğŸ—„ï¸ DurÃ©e de cache des validations (5 minutes)

# Gestion des scans concurrents
MAX_CONCURRENT_SCANS=100
# ğŸ”¢ Nombre maximum de scans simultanÃ©s
SCAN_TIMEOUT=15000
# â° Timeout global pour une opÃ©ration de scan (15 secondes)
MAX_SCANS_PER_TICKET=5
# ğŸ« Nombre maximum de scans par ticket

# Configuration avancÃ©e des scans
ENABLE_SCAN_ANALYTICS=true
# ğŸ“Š Activer l'analyse des scans
ENABLE_SCAN_GEOLOCATION=false
# ğŸŒ Activer la gÃ©olocalisation des scans
SCAN_IMAGE_QUALITY_THRESHOLD=0.7
# ğŸ–¼ï¸ QualitÃ© minimale de l'image pour le scan (0.0-1.0)

# ===========================================
# ğŸ›¡ï¸ FRAUD DETECTION
# ===========================================
FRAUD_DETECTION_ENABLED=true
# âœ… Activer la dÃ©tection de fraude
BLOCK_ON_FRAUD=true
# ğŸš« Bloquer les scans suspects

# Seuils de dÃ©tection de fraude
FRAUD_THRESHOLD_CONCURRENT_SCANS=3
# ğŸ”¢ Seuil de scans concurrents suspects
FRAUD_THRESHOLD_FAILED_SCANS=10
# âŒ Seuil d'Ã©checs de scans suspects
FRAUD_TIME_WINDOW=300000
# â° FenÃªtre de temps pour l'analyse de fraude (5 minutes)

# Configuration avancÃ©e de la dÃ©tection de fraude
ENABLE_BEHAVIOR_ANALYSIS=true
# ğŸ” Activer l'analyse comportementale
ENABLE_VELOCITY_CHECKING=true
# âš¡ Activer la vÃ©rification de vÃ©locitÃ©
FRAUD_SCORE_THRESHOLD=0.8
# ğŸ“Š Seuil de score de fraude (0.0-1.0)
BLACKLIST_ENABLED=true
# ğŸš« Activer la blacklist d'appareils/IPs

# ===========================================
# ğŸ“± OFFLINE MODE
# ===========================================
OFFLINE_MODE=true
# âœ… Activer le mode hors ligne
OFFLINE_DB_PATH=./offline.db
# ğŸ“ Chemin de la base de donnÃ©es offline
SYNC_INTERVAL=30000
# â° Intervalle de synchronisation (30 secondes)
OFFLINE_SYNC_BATCH_SIZE=100
# ğŸ“¦ Taille des lots de synchronisation offline

# Cache offline
OFFLINE_CACHE_TTL=86400000
# ğŸ—„ï¸ DurÃ©e de cache offline (24 heures)
OFFLINE_BACKUP_INTERVAL=3600000
# ğŸ’¾ Intervalle de backup offline (1 heure)
OFFLINE_MAX_CACHE_SIZE=10000
# ğŸ“Š Taille maximale du cache offline (entrÃ©es)

# Configuration avancÃ©e offline
ENABLE_OFFLINE_ANALYTICS=true
# ğŸ“Š Activer les analytics offline
OFFLINE_ENCRYPTION_ENABLED=true
# ğŸ” Chiffrer les donnÃ©es offline
OFFLINE_COMPRESSION_ENABLED=true
# ğŸ—œï¸ Compresser les donnÃ©es offline

# ===========================================
# ğŸ’¾ CACHE REDIS
# ===========================================
REDIS_HOST=localhost
# ğŸ  HÃ´te Redis (localhost en dev, ElastiCache endpoint en prod)
REDIS_PORT=6379
# ğŸšª Port Redis (6379 par dÃ©faut)
REDIS_PASSWORD=
# ğŸ” Mot de passe Redis (optionnel en dev, requis en prod)
REDIS_DB=5
# ğŸ“Š NumÃ©ro de la base Redis (5 pour Scan Validation Service)

# Configuration du cache
CACHE_TTL=300
# â° DurÃ©e de vie du cache en secondes (5 minutes)
CACHE_MAX_KEYS=10000
# ğŸ”¢ Nombre maximum de clÃ©s en cache
CACHE_VALIDATION_RESULTS=true
# âœ… Mettre en cache les rÃ©sultats de validation

# ===========================================
# ğŸ“ LOGGING
# ===========================================
LOG_LEVEL=info
# ğŸ“Š Niveau de log : error | warn | info | debug
LOG_FILE_PATH=logs
# ğŸ“ Chemin des fichiers de log
LOG_MAX_SIZE=20MB
# ğŸ“ Taille maximale d'un fichier de log
LOG_MAX_FILES=14d
# ğŸ“… DurÃ©e de rÃ©tention des logs (14 jours recommandÃ©)

# Logs structurÃ©s
LOG_FORMAT=json
# ğŸ“„ Format des logs (json, text)
LOG_DATE_FORMAT=YYYY-MM-DD HH:mm:ss
# ğŸ“… Format des dates dans les logs

# Activer les logs spÃ©cialisÃ©s
ENABLE_STRUCTURED_LOGS=true
# ğŸ“Š Activer les logs au format JSON
ENABLE_REQUEST_LOGGING=true
# ğŸ“ Activer les logs des requÃªtes HTTP
ENABLE_SCAN_LOGGING=true
# ğŸ“± Activer les logs dÃ©taillÃ©s des scans
ENABLE_FRAUD_LOGGING=true
# ğŸ›¡ï¸ Activer les logs de dÃ©tection de fraude
ENABLE_OFFLINE_LOGGING=true
# ğŸ“± Activer les logs du mode offline

# ===========================================
# ğŸ“Š MONITORING
# ===========================================
ENABLE_METRICS=true
# ğŸ“ˆ Activer les mÃ©triques Prometheus
METRICS_PORT=9095
# ğŸšª Port pour les mÃ©triques (doit Ãªtre unique)

# Health checks
HEALTH_CHECK_INTERVAL=30000
# â° Intervalle des health checks (30 secondes)
HEALTH_CHECK_TIMEOUT=5000
# â° Timeout des health checks (5 secondes)
HEALTH_CHECK_RETRIES=3
# ğŸ”¢ Nombre de tentatives de retry pour les health checks

# Monitoring avancÃ©
ENABLE_PERFORMANCE_MONITORING=true
# ğŸ“ˆ Activer le monitoring des performances
ENABLE_REAL_TIME_DASHBOARD=true
# ğŸ“Š Activer le dashboard temps rÃ©el
ENABLE_ALERTING=true
# ğŸš¨ Activer les alertes automatiques

# ===========================================
# ğŸš¦ RATE LIMITING
# ===========================================
RATE_LIMIT_WINDOW_MS=900000
# â° FenÃªtre de temps pour le rate limiting (900000ms = 15 minutes)
RATE_LIMIT_MAX_REQUESTS=1000
# ğŸ”¢ Nombre max de requÃªtes par fenÃªtre (global)
SCAN_RATE_LIMIT_PER_MINUTE=200
# ğŸ“± Limite de scans par minute

# Rate limiting spÃ©cifique par endpoint
VALIDATION_RATE_LIMIT=500
# âœ… Limite pour l'endpoint de validation
SCAN_RATE_LIMIT=300
# ğŸ“± Limite pour l'endpoint de scan
ANALYTICS_RATE_LIMIT=100
# ğŸ“Š Limite pour l'endpoint d'analytics

# Configuration avancÃ©e du rate limiting
ENABLE_ADAPTIVE_RATE_LIMITING=true
# ğŸ¯ Activer le rate limiting adaptatif
RATE_LIMIT_WHITELIST=127.0.0.1,::1
# ğŸŒ IPs whitelist pour le rate limiting

# ===========================================
# ğŸ›¡ï¸ SÃ‰CURITÃ‰
# ===========================================
CORS_ORIGIN=*
# ğŸŒ Origines autorisÃ©es pour CORS (* pour public, spÃ©cifier en prod)
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
# ğŸ”§ MÃ©thodes HTTP autorisÃ©es
CORS_ALLOWED_HEADERS=Content-Type,Authorization
# ğŸ“‹ En-tÃªtes HTTP autorisÃ©s

# SÃ©curitÃ© de base (sans authentification)
HELMET_ENABLED=true
# ğŸª– Activer les en-tÃªtes de sÃ©curitÃ© Helmet
COMPRESSION_ENABLED=true
# ğŸ—œï¸ Activer la compression des rÃ©ponses
BODY_PARSER_LIMIT=10mb
# ğŸ“ Limite de taille du corps des requÃªtes

# Configuration sÃ©curitÃ© avancÃ©e
ENABLE_IP_WHITELIST=false
# âœ… Activer le whitelist d'IPs
ALLOWED_IPS=127.0.0.1,::1
# ğŸŒ Adresses IP autorisÃ©es (sÃ©parer par des virgules)
ENABLE_REQUEST_VALIDATION=true
# âœ… Activer la validation stricte des requÃªtes
ENABLE_INPUT_SANITIZATION=true
# ğŸ§¹ Activer la sanitisation des entrÃ©es

# ===========================================
# âš¡ PERFORMANCE
# ===========================================
# Validation concurrency
VALIDATION_CONCURRENCY=10
# ğŸ”¢ Nombre de validations parallÃ¨les
OFFLINE_SYNC_CONCURRENCY=5
# ğŸ”„ Nombre de synchronisations offline parallÃ¨les

# Cache configuration
CACHE_TTL=300000
# â° DurÃ©e de vie du cache (5 minutes)
CACHE_MAX_SIZE=1000
# ğŸ“Š Taille maximale du cache (entrÃ©es)
ENABLE_CACHE_WARMING=true
# ğŸ”¥ Activer le prÃ©chauffage du cache

# Performance avancÃ©e
ENABLE_CONNECTION_POOLING=true
# ğŸ”— Activer le pooling de connexions
ENABLE_ASYNC_PROCESSING=true
# âš¡ Activer le traitement asynchrone
ENABLE_BATCH_PROCESSING=true
# ğŸ“¦ Activer le traitement par lots

# ===========================================
# ğŸ”„ SYNCHRONISATION
# ===========================================
SYNC_RETRY_ATTEMPTS=3
# ğŸ”¢ Nombre de tentatives de retry pour la synchronisation
SYNC_RETRY_DELAY=5000
# â° DÃ©lai entre les retries de synchronisation (5 secondes)
SYNC_TIMEOUT=10000
# â° Timeout pour les opÃ©rations de synchronisation (10 secondes)
SYNC_COMPRESSION_ENABLED=true
# ğŸ—œï¸ Activer la compression des donnÃ©es de synchronisation

# Configuration avancÃ©e de synchronisation
ENABLE_INCREMENTAL_SYNC=true
# ğŸ“ˆ Activer la synchronisation incrÃ©mentale
SYNC_CONFLICT_RESOLUTION=latest
# âš–ï¸ StratÃ©gie de rÃ©solution de conflits (latest, manual)
ENABLE_SYNC_VALIDATION=true
# âœ… Valider les donnÃ©es avant synchronisation

# ===========================================
# ğŸ“ˆ STATISTIQUES
# ===========================================
STATS_AGGREGATION_INTERVAL=60000
# â° Intervalle d'agrÃ©gation des statistiques (1 minute)
STATS_RETENTION_PERIOD=2592000000
# ğŸ“… PÃ©riode de rÃ©tention des statistiques (30 jours)
STATS_REAL_TIME_UPDATES=true
# ğŸ“ˆ Activer les mises Ã  jour en temps rÃ©el

# Configuration avancÃ©e des statistiques
ENABLE_DETAILED_ANALYTICS=true
# ğŸ“Š Activer les analytics dÃ©taillÃ©s
ENABLE_PREDICTIVE_ANALYTICS=false
# ğŸ”® Activer les analytics prÃ©dictifs
STATS_EXPORT_ENABLED=true
# ğŸ“¤ Activer l'export des statistiques
STATS_EXPORT_FORMAT=json
# ğŸ“„ Format d'export des statistiques (json, csv)

# ===========================================
# ğŸ—‚ï¸ NETTOYAGE AUTOMATIQUE
# ===========================================
CLEANUP_ENABLED=true
# âœ… Activer le nettoyage automatique
CLEANUP_INTERVAL=86400000
# â° Intervalle de nettoyage (24 heures)
CLEANUP_RETENTION_DAYS=90
# ğŸ“… DurÃ©e de rÃ©tention des donnÃ©es (90 jours)

# Configuration avancÃ©e du nettoyage
CLEANUP_LOGS_ENABLED=true
# ğŸ“ Activer les logs de nettoyage
CLEANUP_DRY_RUN=false
# ğŸ” Mode simulation du nettoyage
ENABLE_GRACEFUL_CLEANUP=true
# ğŸ•Šï¸ Activer le nettoyage gracieux

# ===========================================
# ğŸ§ª TESTS & DÃ‰VELOPPEMENT
# ===========================================
ENABLE_MOCK_SERVICES=false
# ğŸ§ª Activer les services mockÃ©s pour les tests
ENABLE_DEBUG_MODE=false
# ğŸ› Activer le mode debug (informations supplÃ©mentaires)
ENABLE_PERFORMANCE_PROFILING=false
# ğŸ“ˆ Activer le profiling des performances (uniquement en dev)

# Configuration de test
TEST_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/event_planner_scan_test
# ğŸ§ª URL de la base de donnÃ©es de test
TEST_TIMEOUT=10000
# â° Timeout pour les tests (10 secondes)
ENABLE_MOCK_VALIDATION=true
# ğŸ« Mock la validation de QR codes en test
ENABLE_MOCK_OFFLINE_MODE=true
# ğŸ“± Mock le mode offline en test
